name: Update simple â˜ âœ”ï¸
on:
  push:
    paths:
      - "output/*.txt"  # ç›‘å¬ output ç›®å½•ä¸‹çš„ .txt æ–‡ä»¶å˜æ›´
  schedule:
    - cron: '50 21 * * *'  
  workflow_dispatch:
    inputs:
      keep_lines:
        description: 'æ¯ç»„ä¿ç•™é‡å¤é¢‘é“æ•°'
        required: false
        default: '1'

jobs:
  run:
    runs-on: ubuntu-latest
    permissions:
      contents: write  

    steps:
      - name: æ‹‰å–ä»£ç ï¼ˆé”å®š main åˆ†æ”¯ï¼‰
        uses: actions/checkout@v2
        with:
          ref: main

      - name: å¼ºåˆ¶åŒæ­¥è¿œç¨‹ä»£ç 
        run: git fetch --prune && git reset --hard origin/main

      - name: è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v2
        with:
          python-version: '3.10'

      - name: æ‰§è¡Œè„šæœ¬ï¼ˆå¤„ç† output ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰
        env:
          KEEP_LINES: ${{ github.event.inputs.keep_lines || '1' }}  
        run: python assets/simple/simple.py  # è„šæœ¬è·¯å¾„æ ¹æ®å®é™…è°ƒæ•´

      - name: æäº¤å˜æ›´
        run: |
          mkdir -p output/simple  # ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨
          git config --local user.email "actions@github.com"
          git config --local user.name "GitHub Action"
          git add -f output/simple/  # æäº¤ output/simple ç›®å½•
          git commit -m "ğŸ“¡ $(date +'%Y-%m-%d %H:%M:%S')"  
          git push origin main --force-with-lease || git push origin main --force  

      - name: è°ƒè¯•è¾“å‡º
        run: echo "âœ… æ‰§è¡Œå®Œæˆï¼Œè§¦å‘æºï¼š${{ github.event_name }}"
